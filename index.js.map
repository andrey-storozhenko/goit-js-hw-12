{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nexport const getImagesByQuery = async (query, page) => {\n    const params = new URLSearchParams({\n        per_page:15,\n        page: page\n    });\n    const response = await axios.get(`https://pixabay.com/api/?${params}`, {\n        params: {\n            key: \"53600015-5f1ba847ab2f19cbbd3287585\",\n            q: query,\n            image_type: \"photo\",\n            orientation: \"horizontal\",\n            safesearch: true,\n        }\n    })\n     return {\n        hits: response.data.hits,\n        totalHits: response.data.totalHits\n    };\n};","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\n\nconst gallery = document.querySelector(\".gallery\");\nconst loader = document.querySelector(\".loader\");\nconst fetchCardsBtn = document.querySelector(\".find-more\");\n\nlet gallerySLB = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n});\nexport const createGallery = images => {\n   \n    const markup = images.map(photo => {\n        return `<li class=\"item-gallery\">\n                    <a href=${photo.largeImageURL}>\n                        <img src=${photo.webformatURL} alt=${photo.tags} />\n                    </a>\n                    <ul class=\"stats\">\n                        <li class=\"item-stats\">\n                            <p class=\"text-stats\">Likes</p>\n                            <p class=\"info-stats\">${photo.likes}</p>\n                        </li>\n                        <li class=\"item-stats\">\n                            <p class=\"text-stats\">Views</p>\n                            <p class=\"info-stats\">${photo.views}</p>\n                        </li>\n                        <li class=\"item-stats\">\n                            <p class=\"text-stats\">Comments</p>\n                            <p class=\"info-stats\">${photo.comments}</p>\n                        </li>\n                        <li class=\"item-stats\">\n                            <p class=\"text-stats\">Downloads</p>\n                            <p class=\"info-stats\">${photo.downloads}</p>\n                        </li>\n                    </ul>\n                </li>`\n    })  \n        .join(\"\");\n\n    gallery.insertAdjacentHTML(\"beforeend\", markup);\n    gallerySLB.refresh();\n};\n\n\nexport function clearGallery(){\n    gallery.innerHTML = \"\";\n}\n\nexport function showLoader() {\n    loader.classList.add(\"showLoader\");\n    loader.classList.remove(\"hideLoader\");\n}\nexport function hideLoader() {\n    loader.classList.remove(\"showLoader\");\n    loader.classList.add(\"hideLoader\");\n}\nexport function showLoadMoreButton() {\n    fetchCardsBtn.classList.add(\"showLoadMoreButton\");\n    fetchCardsBtn.classList.remove(\"hideLoadMoreButton\");\n}\nexport function hideLoadMoreButton() {\n    fetchCardsBtn.classList.remove(\"showLoadMoreButton\");\n    fetchCardsBtn.classList.add(\"hideLoadMoreButton\");\n}\n\n","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport { getImagesByQuery } from './js/pixabay-api';\nimport { createGallery } from './js/render-functions';\nimport { clearGallery } from \"./js/render-functions\";\nimport { showLoader, hideLoader } from \"./js/render-functions\";\nimport { showLoadMoreButton, hideLoadMoreButton } from './js/render-functions';\n\n\nconst form = document.querySelector(\"form\");\nconst fetchCardsBtn = document.querySelector(\".find-more\");\nlet lastQuery = \"\";\nlet page = 1;\nlet totalPages = 0; \nlet perPage = 0;\n\nform.addEventListener(\"submit\", async (event) => {\n    event.preventDefault();\n\n    clearGallery();\n    hideLoadMoreButton();\n    showLoader();\n\n    const query = form.elements['search-text'].value;\n   \n    if (!query.trim()) {\n        hideLoader();\n        iziToast.show({ message: \"Type something!\" });\n        return;\n    }\n\n    if (lastQuery !== query) {\n        page = 1;\n    }\n\n    lastQuery = query;\n\n    try {\n        const cards = await getImagesByQuery(query, page);\n        if (page === 1) {\n            perPage = cards.hits.length;\n        }\n        totalPages = Math.ceil(cards.totalHits / perPage);\n\n        if (totalPages === 1) {\n            iziToast.show({  position: \"topRight\", message: \"We're sorry, but you've reached the end of search results\" });\n            hideLoadMoreButton();\n            hideLoader();\n            return createGallery(cards.hits);\n        }\n        \n        if (!cards.hits.length) {\n            clearGallery();\n            iziToast.show({ message: \"Sorry, there are no images matching your search query. Please try again!\" });\n            return;\n        }\n        createGallery(cards.hits); \n    \n        if (totalPages > 1 && page <= totalPages) {\n            showLoadMoreButton();\n        }\n        page += 1;\n    } catch(error){\n          iziToast.show({ message: \"Something went wrong. Try again!\" });\n    } finally {\n        hideLoader();\n    }\n});\n\nfetchCardsBtn.addEventListener(\"click\", async () => {\n    hideLoadMoreButton();\n    showLoader();\n    if (page > totalPages) {\n        hideLoader();\n        hideLoadMoreButton();\n        return iziToast.show({\n        position: \"topRight\",\n        message: \"We're sorry, but you've reached the end of search results.\"\n        });\n    } \n        try {\n            const moreCards = await getImagesByQuery(lastQuery, page);\n            if (!moreCards.hits || moreCards.hits.length === 0) {\n                hideLoadMoreButton();\n                iziToast.show({\n                    position: \"topRight\",\n                    message: \"No more images found\"\n                });\n                return;\n            }\n            createGallery(moreCards.hits);\n\n            let elem = document.querySelector(\".item-gallery\");\n            let rect = elem.getBoundingClientRect();\n            window.scrollBy({\n                top: rect.height * 2,\n                behavior: 'smooth',\n            });\n\n            page += 1;\n            if (page <= totalPages) {\n                showLoadMoreButton();\n            } else {\n                iziToast.show({\n                    position: \"topRight\",\n                    message: \"You've reached the end of search results\"\n                });\n            }\n        } catch(error){\n             iziToast.show({ message: \"Problem with fetchind cards!\" });\n        } finally {\n            hideLoader();\n        }\n});\n\n\n\n"],"names":["getImagesByQuery","query","page","params","response","axios","gallery","loader","fetchCardsBtn","gallerySLB","SimpleLightbox","createGallery","images","markup","photo","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","form","lastQuery","totalPages","perPage","event","iziToast","cards","moreCards","rect"],"mappings":"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"}